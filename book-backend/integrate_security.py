#!/usr/bin/env python3\n\"\"\"\nScript to integrate comprehensive security measures into the existing FastAPI application.\n\"\"\"\n\nimport sys\nimport os\n\n# Add the src directory to the Python path\nsys.path.insert(0, os.path.join(os.path.dirname(__file__), 'src'))\n\ntry:\n    from src.security.security_integration import setup_comprehensive_security\n    from src.security.security_config import SecurityConfig, SecurityLevel\n    \n    def integrate_security_into_app(app):\n        \"\"\"\n        Integrate comprehensive security into an existing FastAPI app.\n        \n        Args:\n            app: FastAPI application instance\n        \"\"\"\n        \n        # Create security configuration\n        security_config = SecurityConfig(\n            environment=os.getenv('ENVIRONMENT', 'development'),\n            security_level=SecurityLevel.HIGH,\n            enable_rate_limiting=True,\n            enable_csrf_protection=True,\n            enable_security_headers=True,\n            enable_https_only=os.getenv('ENVIRONMENT') == 'production',\n            enable_input_sanitization=True,\n            enable_session_tracking=True,\n            enable_intrusion_detection=True,\n        )\n        \n        # Set up comprehensive security\n        setup_comprehensive_security(app, security_config)\n        \n        print(\"‚úÖ Security integration completed successfully!\")\n        print(f\"üîí Security level: {security_config.security_level}\")\n        print(f\"üåç Environment: {security_config.environment}\")\n        \n        return app\n    \n    # Example usage for existing main.py\n    def update_main_py():\n        \"\"\"\n        Show how to update the existing main.py file.\n        \"\"\"\n        print(\"\\nüìù To integrate security into your existing main.py, add these lines:\")\n        print(\"\\n\" + \"=\"*60)\n        print(\"# Add these imports at the top:\")\n        print(\"from src.security.security_integration import setup_comprehensive_security\")\n        print(\"from src.security.security_config import SecurityConfig, SecurityLevel\")\n        print(\"\\n# Add this after creating your FastAPI app:\")\n        print(\"security_config = SecurityConfig(\")\n        print(\"    environment=os.getenv('ENVIRONMENT', 'development'),\")\n        print(\"    security_level=SecurityLevel.HIGH,\")\n        print(\"    enable_rate_limiting=True,\")\n        print(\"    enable_csrf_protection=True,\")\n        print(\"    enable_security_headers=True,\")\n        print(\"    enable_https_only=os.getenv('ENVIRONMENT') == 'production',\")\n        print(\")\")\n        print(\"setup_comprehensive_security(app, security_config)\")\n        print(\"=\"*60)\n        \n    if __name__ == \"__main__\":\n        print(\"üîê Security Integration Script\")\n        print(\"This script helps integrate comprehensive security into your FastAPI application.\")\n        \n        update_main_py()\n        \n        print(\"\\nüöÄ Security features that will be enabled:\")\n        print(\"  ‚úì Rate limiting with configurable limits\")\n        print(\"  ‚úì CSRF protection for state-changing operations\")\n        print(\"  ‚úì Comprehensive security headers\")\n        print(\"  ‚úì Input validation and sanitization\")\n        print(\"  ‚úì SQL injection protection\")\n        print(\"  ‚úì XSS protection\")\n        print(\"  ‚úì Session security and tracking\")\n        print(\"  ‚úì Authentication middleware\")\n        print(\"  ‚úì IP filtering and geoblocking (configurable)\")\n        print(\"  ‚úì File upload security\")\n        print(\"  ‚úì Error handling and logging\")\n        print(\"  ‚úì HTTPS enforcement (in production)\")\n        print(\"  ‚úì Intrusion detection\")\n        \n        print(\"\\nüìä Security endpoints that will be available:\")\n        print(\"  ‚Ä¢ GET /security/status - Security configuration status\")\n        print(\"  ‚Ä¢ GET /security/health - Security health check\")\n        \n        print(\"\\n‚öôÔ∏è  Configuration can be customized via environment variables:\")\n        print(\"  ‚Ä¢ SECURITY_ENVIRONMENT - Environment (development/production)\")\n        print(\"  ‚Ä¢ SECURITY_SECURITY_LEVEL - Security level (low/medium/high/maximum)\")\n        print(\"  ‚Ä¢ SECURITY_ENABLE_RATE_LIMITING - Enable rate limiting (true/false)\")\n        print(\"  ‚Ä¢ SECURITY_JWT_SECRET_KEY - JWT secret key\")\n        print(\"  ‚Ä¢ SECURITY_ACCESS_TOKEN_EXPIRE_MINUTES - Token expiration time\")\n        print(\"  ‚Ä¢ And many more...\")\n        \nexcept ImportError as e:\n    print(f\"‚ùå Error importing security modules: {e}\")\n    print(\"Make sure all security files are in place and dependencies are installed.\")\n    sys.exit(1)\nexcept Exception as e:\n    print(f\"‚ùå Unexpected error: {e}\")\n    sys.exit(1)\n"