# # version: '3.8'

# # services:
# #   # Main application with personalization service
# #   app:
# #     build: .
# #     ports:
# #       - "8000:8000"
# #     environment:
# #       - DATABASE_URL=postgresql://postgres:password@db:5432/bookdb
# #       - REDIS_URL=redis://redis:6379/0
# #       - PERSONALIZATION_CACHE_TTL_SECONDS=3600
# #       - PERSONALIZATION_MAX_CACHE_SIZE=1000
# #       - PERSONALIZATION_ENABLE_ANALYTICS=true
# #       - JWT_SECRET_KEY=your-secret-key-change-in-production
# #     depends_on:
# #       - db
# #       - redis
# #     volumes:
# #       - .:/app
# #     command: uvicorn main:app --host 0.0.0.0 --port 8000 --reload

# #   # PostgreSQL database
# #   db:
# #     image: postgres:15
# #     environment:
# #       - POSTGRES_DB=bookdb
# #       - POSTGRES_USER=postgres
# #       - POSTGRES_PASSWORD=password
# #     ports:
# #       - "5432:5432"
# #     volumes:
# #       - postgres_data:/var/lib/postgresql/data
# #       - ./init-db.sql:/docker-entrypoint-initdb.d/init-db.sql

# #   # Redis for caching
# #   redis:
# #     image: redis:7-alpine
# #     ports:
# #       - "6379:6379"
# #     command: redis-server --appendonly yes
# #     volumes:
# #       - redis_data:/data

# #   # Optional: Redis Commander for Redis management
# #   redis-commander:
# #     image: rediscommander/redis-commander:latest
# #     environment:
# #       - REDIS_HOSTS=local:redis:6379
# #     ports:
# #       - "8081:8081"
# #     depends_on:
# #       - redis

# # volumes:
# #   postgres_data:
# #   redis_data:

# #   # docker-compose.personalization.yml ends here 



# version: '3.8'

# services:
#   app:
#     build: .
#     ports:
#       - "8080:8080"  # ✅ Change from 8000 to 8080
#     environment:
#       - PORT=8080  # ✅ Add PORT environment variable
#       - DATABASE_URL=postgresql://postgres:password@db:5432/bookdb
#       - REDIS_URL=redis://redis:6379/0
#       - GEMINI_API_KEY=${GEMINI_API_KEY}  # ✅ Important: Add your API key
#     depends_on:
#       - db
#       - redis
#     command: uvicorn main:app --host 0.0.0.0 --port 8080 --reload  # ✅ Port 8080